<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><link href=https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css integrity=sha512-... crossorigin=anonymous referrerpolicy=no-referrer><meta property="og:title" content="AI Agent with MCP: Smart Meeting Scheduler"><meta property="og:description" content="Context: Why This Project Matters, Who It’s For, and What You’ll Learn
In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation."><meta property="og:type" content="article"><meta property="og:url" content="https://newabdullah.com/posts/ai-agent/"><meta property="og:image" content><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="AI Agent with MCP: Smart Meeting Scheduler"><meta name=twitter:description content="Context: Why This Project Matters, Who It’s For, and What You’ll Learn
In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation."><meta name=twitter:image content><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AI Agent with MCP: Smart Meeting Scheduler | Abdullah Al Mamun</title>
<meta name=keywords content="AI agent,MCP,calendar automation,gmail automation,LLM commands,OpenAI,Google Calendar API,Gmail API"><meta name=description content="Context: Why This Project Matters, Who It’s For, and What You’ll Learn
In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation."><meta name=author content="Abdullah Al Mamun"><link rel=canonical href=https://newabdullah.com/posts/ai-agent/><link crossorigin=anonymous href=/assets/css/stylesheet.c12a1208b6212e62f9164f8e928224324f88ac6630dca9bd54d7c312df35e1eb.css integrity="sha256-wSoSCLYhLmL5Fk+OkoIkMk+IrGYw3Km9VNfDEt814es=" rel="preload stylesheet" as=style><link rel=icon href=https://newabdullah.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://newabdullah.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://newabdullah.com/favicon-32x32.png><link rel=apple-touch-icon href=https://newabdullah.com/apple-touch-icon.png><link rel=mask-icon href=https://newabdullah.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://newabdullah.com/posts/ai-agent/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://newabdullah.com/posts/ai-agent/"><meta property="og:site_name" content="Abdullah Al Mamun"><meta property="og:title" content="AI Agent with MCP: Smart Meeting Scheduler"><meta property="og:description" content="Context: Why This Project Matters, Who It’s For, and What You’ll Learn In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-11T00:00:00+00:00"><meta property="article:tag" content="AI Agent"><meta property="article:tag" content="MCP"><meta property="article:tag" content="Calendar Automation"><meta property="article:tag" content="Gmail Automation"><meta property="article:tag" content="LLM Commands"><meta property="article:tag" content="OpenAI"><meta name=twitter:card content="summary"><meta name=twitter:title content="AI Agent with MCP: Smart Meeting Scheduler"><meta name=twitter:description content="Context: Why This Project Matters, Who It’s For, and What You’ll Learn
In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://newabdullah.com/posts/"},{"@type":"ListItem","position":2,"name":"AI Agent with MCP: Smart Meeting Scheduler","item":"https://newabdullah.com/posts/ai-agent/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AI Agent with MCP: Smart Meeting Scheduler","name":"AI Agent with MCP: Smart Meeting Scheduler","description":"Context: Why This Project Matters, Who It’s For, and What You’ll Learn In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation.\n","keywords":["AI agent","MCP","calendar automation","gmail automation","LLM commands","OpenAI","Google Calendar API","Gmail API"],"articleBody":"Context: Why This Project Matters, Who It’s For, and What You’ll Learn In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation.\nYou’ll learn how an AI agent can understand contextual prompts and use structured protocols like MCP to call APIs for practical outcomes—like scheduling a meeting or notifying participants via Gmail. If you’re interested in automating workflows with natural language interfaces, this is for you.\nBackground: What Inspired This Project The idea came from a common frustration—having to juggle between chat, calendars, and emails just to organize one meeting. So I built a smart AI agent that interprets my intent using OpenAI’s LLM, and then takes real-world actions using:\nGoogle Calendar API to schedule meetings. Gmail API to send emails. MCP (Model Context Protocol) to structure and manage context-aware tasks reliably. import os import sys import time from openai import OpenAI, RateLimitError from dotenv import load_dotenv from typing import Optional import backoff # Load environment variables sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))) load_dotenv() # Constants THREAD_ID_FILE = \"thread_id.txt\" MODEL_NAME = \"gpt-4-turbo\" MAX_RETRIES = 3 INITIAL_RETRY_DELAY = 2 MAX_RETRY_DELAY = 60 class AssistantManager: def __init__(self): # Initialize API key and OpenAI client self.api_key = os.getenv(\"OPENAI_API_KEY\") self.client = OpenAI(api_key=self.api_key, timeout=60.0, max_retries=5) # Test API connection with retries self.test_api_connection() # Load assistant configuration self.assistant_id = os.getenv(\"ASSISTANT_ID\") self.load_or_create_assistant() # Load thread ID self.thread_id = self.load_thread_id() def test_api_connection(self): # Retry connection if rate limit error occurs retry_count = 0 while retry_count \u003c MAX_RETRIES: try: models = self.client.models.list() break except RateLimitError as e: retry_count += 1 time.sleep(min(INITIAL_RETRY_DELAY * (2 ** retry_count), MAX_RETRY_DELAY)) def load_or_create_assistant(self): try: self.assistant = self.client.beta.assistants.retrieve(self.assistant_id) except Exception: self.create_new_assistant() def create_new_assistant(self): # Create a new assistant if not found self.assistant = self.client.beta.assistants.create( name=\"Email Assistant\", instructions=\"Assistant instructions\", model=MODEL_NAME ) self.assistant_id = self.assistant.id def load_thread_id(self) -\u003e Optional[str]: # Load thread ID from file if os.path.exists(THREAD_ID_FILE): with open(THREAD_ID_FILE, \"r\") as file: return file.read().strip() return None def save_thread_id(self, thread_id: str) -\u003e None: # Save thread ID to file with open(THREAD_ID_FILE, \"w\") as file: file.write(thread_id) def process_user_input(self, user_input: str) -\u003e bool: # Process user input, reset thread or quit if user_input.lower() == \"reset\": self.reset_thread() return True elif user_input.lower() == \"quit\": print(\"Goodbye.\") return False # Handle conversation logic return True def reset_thread(self) -\u003e None: # Reset the conversation thread self.thread_id = None if os.path.exists(THREAD_ID_FILE): os.remove(THREAD_ID_FILE) def run(self) -\u003e None: # Main conversation loop while True: user_input = input(\"Enter your message: \") if not self.process_user_input(user_input): break if __name__ == \"__main__\": assistant_manager = AssistantManager() assistant_manager.run() How It Works: Behind the Scenes The agent listens to a single instruction like:\n“Schedule a meeting with Mamun on Monday at 3 PM about the RecSys project and send him a confirmation email.”\nAnd it performs the following steps:\nParses the command using OpenAI LLM. Creates an MCP request to store the user’s intent and current context. Calls the Google Calendar API to create a new event. Uses the Gmail API to send a formatted email with meeting details. The key here is context tracking with MCP. It ensures the agent understands who is involved, when the meeting should occur, and what it’s about—even if I just say, “Book it like the last one, but with Sara.”\nKey Components \u0026 Technologies OpenAI GPT-4: For command parsing and decision-making. MCP (Model Context Protocol): For structuring AI-agent memory and task execution. Google Calendar API: For event creation and modification. Gmail API: For sending meeting emails. Python \u0026 Flask: As the glue to orchestrate LLM output and API calls. Future Scope Add voice command support. Allow recurring meetings and conflict resolution. Integrate Slack or WhatsApp bot support for command input. Final Thoughts This agent proves how AI isn’t just about chat—it’s about action. With just one sentence, I can automate multiple backend operations, making daily workflows faster and smarter. I’ll be sharing the full code soon. Feel free to connect if you want to build one yourself!\n","wordCount":"689","inLanguage":"en","datePublished":"2025-04-11T00:00:00Z","dateModified":"2025-04-11T00:00:00Z","author":[{"@type":"Person","name":"Abdullah Al Mamun"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://newabdullah.com/posts/ai-agent/"},"publisher":{"@type":"Organization","name":"Abdullah Al Mamun","logo":{"@type":"ImageObject","url":"https://newabdullah.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://newabdullah.com/ accesskey=h title="Abdullah Al Mamun (Alt + H)">Abdullah Al Mamun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><button class=menu-toggle onclick=toggleMenu()>☰</button><ul id=menu><li><a href=https://newabdullah.com/archives title=Blog><span>Blog</span></a></li><li><a href=https://newabdullah.com/about title="About Me"><span>About Me</span></a></li><li><a href=https://www.newabdullah.com/Abdullah_Resume.pdf title=Resume><span>Resume</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://newabdullah.com/gallery/ title=Gallery><span>Gallery</span></a></li><li><a href=https://newabdullah.com/contact title=Contact><span>Contact</span></a></li><li><a href=https://www.linkedin.com/in/newabdullah/ title=Linkedin><span><i class='fab fa-linkedin'></i>Linkedin</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://newabdullah.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">AI Agent with MCP: Smart Meeting Scheduler</h1><div class=post-meta><span title='2025-04-11 00:00:00 +0000 UTC'>April 11, 2025</span>&nbsp;·&nbsp;Abdullah Al Mamun</div></header><div class=post-content><h2 id=context-why-this-project-matters-who-its-for-and-what-youll-learn>Context: Why This Project Matters, Who It’s For, and What You’ll Learn<a hidden class=anchor aria-hidden=true href=#context-why-this-project-matters-who-its-for-and-what-youll-learn>#</a></h2><p>In this post, I’m excited to share a recent development—an AI agent powered by the Model Context Protocol (MCP), OpenAI, and Google APIs that can set up meetings on your calendar and send notification emails, all triggered by simple natural language commands. This project is designed for developers, tech enthusiasts, and productivity geeks who want to explore the power of LLMs in real-world task automation.</p><p>You&rsquo;ll learn how an AI agent can understand contextual prompts and use structured protocols like MCP to call APIs for practical outcomes—like scheduling a meeting or notifying participants via Gmail. If you&rsquo;re interested in automating workflows with natural language interfaces, this is for you.</p><h2 id=background-what-inspired-this-project>Background: What Inspired This Project<a hidden class=anchor aria-hidden=true href=#background-what-inspired-this-project>#</a></h2><p>The idea came from a common frustration—having to juggle between chat, calendars, and emails just to organize one meeting. So I built a smart AI agent that interprets my intent using OpenAI&rsquo;s LLM, and then takes real-world actions using:</p><ul><li><strong>Google Calendar API</strong> to schedule meetings.</li><li><strong>Gmail API</strong> to send emails.</li><li><strong>MCP (Model Context Protocol)</strong> to structure and manage context-aware tasks reliably.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>openai</span> <span class=kn>import</span> <span class=n>OpenAI</span><span class=p>,</span> <span class=n>RateLimitError</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>backoff</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load environment variables</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Constants</span>
</span></span><span class=line><span class=cl><span class=n>THREAD_ID_FILE</span> <span class=o>=</span> <span class=s2>&#34;thread_id.txt&#34;</span>
</span></span><span class=line><span class=cl><span class=n>MODEL_NAME</span> <span class=o>=</span> <span class=s2>&#34;gpt-4-turbo&#34;</span>
</span></span><span class=line><span class=cl><span class=n>MAX_RETRIES</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>INITIAL_RETRY_DELAY</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>MAX_RETRY_DELAY</span> <span class=o>=</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AssistantManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Initialize API key and OpenAI client</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;OPENAI_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>client</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>(</span><span class=n>api_key</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>api_key</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mf>60.0</span><span class=p>,</span> <span class=n>max_retries</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Test API connection with retries</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>test_api_connection</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Load assistant configuration</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assistant_id</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;ASSISTANT_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>load_or_create_assistant</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Load thread ID</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_thread_id</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_api_connection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Retry connection if rate limit error occurs</span>
</span></span><span class=line><span class=cl>        <span class=n>retry_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>retry_count</span> <span class=o>&lt;</span> <span class=n>MAX_RETRIES</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>models</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>models</span><span class=o>.</span><span class=n>list</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>RateLimitError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>retry_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=nb>min</span><span class=p>(</span><span class=n>INITIAL_RETRY_DELAY</span> <span class=o>*</span> <span class=p>(</span><span class=mi>2</span> <span class=o>**</span> <span class=n>retry_count</span><span class=p>),</span> <span class=n>MAX_RETRY_DELAY</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>load_or_create_assistant</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>assistant</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>beta</span><span class=o>.</span><span class=n>assistants</span><span class=o>.</span><span class=n>retrieve</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>assistant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>create_new_assistant</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_new_assistant</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Create a new assistant if not found</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assistant</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>beta</span><span class=o>.</span><span class=n>assistants</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=s2>&#34;Email Assistant&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>instructions</span><span class=o>=</span><span class=s2>&#34;Assistant instructions&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>=</span><span class=n>MODEL_NAME</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assistant_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>assistant</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>load_thread_id</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Load thread ID from file</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>THREAD_ID_FILE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>THREAD_ID_FILE</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save_thread_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>thread_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Save thread ID to file</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>THREAD_ID_FILE</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>thread_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_user_input</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_input</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Process user input, reset thread or quit</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_input</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;reset&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>reset_thread</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>user_input</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;quit&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Goodbye.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=c1># Handle conversation logic</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset_thread</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Reset the conversation thread</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread_id</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>THREAD_ID_FILE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>THREAD_ID_FILE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Main conversation loop</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>user_input</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter your message: &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>process_user_input</span><span class=p>(</span><span class=n>user_input</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>assistant_manager</span> <span class=o>=</span> <span class=n>AssistantManager</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>assistant_manager</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=how-it-works-behind-the-scenes>How It Works: Behind the Scenes<a hidden class=anchor aria-hidden=true href=#how-it-works-behind-the-scenes>#</a></h2><p>The agent listens to a single instruction like:<br><strong>“Schedule a meeting with Mamun on Monday at 3 PM about the RecSys project and send him a confirmation email.”</strong></p><p>And it performs the following steps:</p><ol><li><strong>Parses the command</strong> using OpenAI LLM.</li><li><strong>Creates an MCP request</strong> to store the user’s intent and current context.</li><li><strong>Calls the Google Calendar API</strong> to create a new event.</li><li><strong>Uses the Gmail API</strong> to send a formatted email with meeting details.</li></ol><p>The key here is <strong>context tracking with MCP</strong>. It ensures the agent understands who is involved, when the meeting should occur, and what it’s about—even if I just say, “Book it like the last one, but with Sara.”</p><h2 id=key-components--technologies>Key Components & Technologies<a hidden class=anchor aria-hidden=true href=#key-components--technologies>#</a></h2><ul><li><strong>OpenAI GPT-4</strong>: For command parsing and decision-making.</li><li><strong>MCP (Model Context Protocol)</strong>: For structuring AI-agent memory and task execution.</li><li><strong>Google Calendar API</strong>: For event creation and modification.</li><li><strong>Gmail API</strong>: For sending meeting emails.</li><li><strong>Python & Flask</strong>: As the glue to orchestrate LLM output and API calls.</li></ul><h2 id=future-scope>Future Scope<a hidden class=anchor aria-hidden=true href=#future-scope>#</a></h2><ul><li>Add voice command support.</li><li>Allow recurring meetings and conflict resolution.</li><li>Integrate Slack or WhatsApp bot support for command input.</li></ul><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>This agent proves how AI isn’t just about chat—it’s about action. With just one sentence, I can automate multiple backend operations, making daily workflows faster and smarter. I’ll be sharing the full code soon. Feel free to connect if you want to build one yourself!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://newabdullah.com/tags/ai-agent/>AI Agent</a></li><li><a href=https://newabdullah.com/tags/mcp/>MCP</a></li><li><a href=https://newabdullah.com/tags/calendar-automation/>Calendar Automation</a></li><li><a href=https://newabdullah.com/tags/gmail-automation/>Gmail Automation</a></li><li><a href=https://newabdullah.com/tags/llm-commands/>LLM Commands</a></li><li><a href=https://newabdullah.com/tags/openai/>OpenAI</a></li><li><a href=https://newabdullah.com/tags/google-calendar-api/>Google Calendar API</a></li><li><a href=https://newabdullah.com/tags/gmail-api/>Gmail API</a></li></ul><head><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css rel=stylesheet></head><div class=share-wrapper><button class=top-button>
<i class="fas fa-share-alt"></i> Share</button><div class=share-buttons><a href="https://twitter.com/share?url=https%3a%2f%2fnewabdullah.com%2fposts%2fai-agent%2f&text=AI%20Agent%20with%20MCP%3a%20Smart%20Meeting%20Scheduler" target=_blank aria-label="Share on Twitter"><i class="fab fa-twitter"></i>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fnewabdullah.com%2fposts%2fai-agent%2f" target=_blank aria-label="Share on Facebook"><i class="fab fa-facebook-f"></i>
</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnewabdullah.com%2fposts%2fai-agent%2f&title=AI%20Agent%20with%20MCP%3a%20Smart%20Meeting%20Scheduler" target=_blank aria-label="Share on LinkedIn"><i class="fab fa-linkedin-in"></i>
</a><a href="mailto:?subject=AI%20Agent%20with%20MCP%3a%20Smart%20Meeting%20Scheduler&body=https%3a%2f%2fnewabdullah.com%2fposts%2fai-agent%2f" aria-label="Share via Email"><i class="fas fa-envelope"></i></a></div></div><div class=buy-me-a-coffee style=margin-top:1.5rem><a href=https://www.buymeacoffee.com/YOUR_USERNAME target=_blank aria-label="Support me with a coffee"><img src=https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png alt="Buy Me a Coffee" style=height:50px;border:0></a></div><div class=recent-posts style=margin-top:3rem><h2 class=headline>Recent Posts</h2><div style=display:flex;flex-wrap:wrap;gap:1rem><div style="border:1px solid #e0e0e0;border-radius:8px;padding:1rem;width:100%;max-width:250px"><a href=/posts/the-evaluation-of-recsys-part-3/ style=text-decoration:none;color:inherit><h3 style="font-size:1.1rem;margin:0 0 .5rem">The Evaluation of RecSys - Part 3</h3><p style=font-size:.85rem;color:#666>Mar 12, 2025</p></a></div><div style="border:1px solid #e0e0e0;border-radius:8px;padding:1rem;width:100%;max-width:250px"><a href=/posts/the-evaluation-of-recsys-part2/ style=text-decoration:none;color:inherit><h3 style="font-size:1.1rem;margin:0 0 .5rem">The Evaluation of RecSys - Part 2</h3><p style=font-size:.85rem;color:#666>Mar 11, 2025</p></a></div></div></div></footer><script src=https://giscus.app/client.js data-repo=salahuddinjony/newabdullah.com data-repo-id=R_kgDOOVz2cg data-category=General data-category-id=DIC_kwDOOVz2cs4Co_xs data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=dark data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>© [newabdullah 2025]</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>function toggleMenu(){document.getElementById("menu").classList.toggle("show")}</script></body></html>